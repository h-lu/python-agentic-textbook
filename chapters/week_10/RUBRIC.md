# Week 10 评分标准

## 总分构成

| 维度 | 分值 | 说明 |
|------|------|------|
| 代码正确性 | 40 分 | 代码能正确运行，实现预期功能 |
| JSON 处理能力 | 25 分 | 正确使用 json 模块，处理序列化和反序列化 |
| 异常处理与健壮性 | 20 分 | 妥善处理各种错误情况和边界条件 |
| 代码质量与风格 | 15 分 | 命名规范、注释完整、符合 PEP 8 |

**总分**：100 分

---

## 评分细则

### 1. 代码正确性（40 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|----------|
| **练习 1：JSON 基础读写** | 10 分 | - 正确使用 `json.dump/load`（3 分）<br>- 正确使用 `json.dumps/loads`（2 分）<br>- 正确处理嵌套结构（3 分）<br>- 正确使用 `indent` 和 `ensure_ascii`（2 分） |
| **练习 2：数据导入导出** | 12 分 | - 导出功能完整（JSON 和 TXT）（4 分）<br>- 导入功能完整（含错误处理）（4 分）<br>- 格式转换功能正确（2 分）<br>- 自动创建目录（2 分） |
| **练习 3：序列化与反序列化** | 8 分 | - 自定义序列化函数正确（3 分）<br>- 自定义反序列化函数正确（3 分）<br>- 日期类型正确恢复（2 分） |
| **练习 4：防御性编程** | 10 分 | - 多编码尝试（3 分）<br>- 数据验证逻辑正确（4 分）<br>- 优雅处理错误数据（3 分） |

**扣分项**：
- 代码无法运行（-10 分/项）
- 功能明显缺失（-5 分/项）
- JSON 解析错误未处理（-5 分/处）
- 文件编码问题导致中文乱码（-3 分/处）

---

### 2. JSON 处理能力（25 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|----------|
| **json 模块使用** | 10 分 | - 正确区分 `dump` 和 `dumps`（3 分）<br>- 正确区分 `load` 和 `loads`（3 分）<br>- 正确使用文件编码参数（4 分） |
| **序列化与反序列化** | 8 分 | - 理解序列化概念（2 分）<br>- 能处理自定义类型（3 分）<br>- 正确使用 `default` 和 `object_hook`（3 分） |
| **数据格式处理** | 7 分 | - 支持多种导出格式（4 分）<br>- 正确处理嵌套数据结构（3 分） |

**扣分项**：
- 混淆 `dump` 和 `dumps` 的使用场景（-5 分）
- 忘记指定 `encoding='utf-8'`（-3 分/处）
- 日期序列化处理不正确（-5 分）

---

### 3. 异常处理与健壮性（20 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|----------|
| **文件操作异常** | 6 分 | - 处理 `FileNotFoundError`（2 分）<br>- 处理 `PermissionError`（2 分）<br>- 处理编码错误（2 分） |
| **JSON 解析异常** | 6 分 | - 捕获 `JSONDecodeError`（3 分）<br>- 给出清晰的错误提示（3 分） |
| **数据验证** | 5 分 | - 验证数据类型（2 分）<br>- 验证必需字段（2 分）<br>- 处理无效记录（1 分） |
| **防御性编程** | 3 分 | - 前置条件检查（1 分）<br>- 优雅降级（不崩溃）（2 分） |

**扣分项**：
- 未处理文件不存在的情况（-5 分）
- 未处理 JSON 格式错误（-5 分）
- 遇到错误直接崩溃（-8 分）
- 没有数据验证（-5 分）

---

### 4. 代码质量与风格（15 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|----------|
| **命名规范** | 5 分 | - 函数名用小写和下划线（2 分）<br>- 变量名有意义（2 分）<br>- 常量用大写（1 分） |
| **注释与文档** | 5 分 | - 函数有 docstring（2 分）<br>- 复杂逻辑有注释（2 分）<br>- 类型提示（可选，+1 分） |
| **代码结构** | 5 分 | - 使用 `with` 语句管理文件（2 分）<br>- 避免重复代码（2 分）<br>- 适当的函数拆分（1 分） |

**扣分项**：
- 没有使用 `with` 语句（-3 分/处）
- 函数没有 docstring（-1 分/函数）
- 代码格式混乱（缩进不一致）（-3 分）

---

## 等级标准

| 等级 | 分数范围 | 描述 |
|------|---------|------|
| **优秀（A）** | 90-100 分 | JSON 处理正确，异常处理完善，代码健壮，风格规范 |
| **良好（B）** | 80-89 分 | JSON 处理基本正确，有基本的异常处理，代码较规范 |
| **合格（C）** | 70-79 分 | 能完成基本功能，异常处理有遗漏，代码有改进空间 |
| **不合格（D）** | 60-69 分 | 代码能运行但异常处理存在严重问题，或缺少关键功能 |
| **不合格（F）** | < 60 分 | 代码无法运行，或未完成基础作业 |

---

## 常见扣分项速查表

| 问题 | 扣分 | 所属维度 |
|------|------|----------|
| 代码无法运行（语法错误、导入错误） | -10 分/项 | 代码正确性 |
| 功能明显缺失（如缺少某个必需函数） | -5 分/项 | 代码正确性 |
| 混淆 `dump` 和 `dumps` | -5 分 | JSON 处理能力 |
| 忘记指定 `encoding='utf-8'` | -3 分/处 | JSON 处理能力 |
| 中文显示为 `\uXXXX`（未用 `ensure_ascii=False`） | -2 分/处 | JSON 处理能力 |
| 未处理 `FileNotFoundError` | -5 分 | 异常处理与健壮性 |
| 未处理 `JSONDecodeError` | -5 分 | 异常处理与健壮性 |
| 遇到错误直接崩溃 | -8 分 | 异常处理与健壮性 |
| 没有数据验证 | -5 分 | 异常处理与健壮性 |
| 未使用 `with` 语句 | -3 分/处 | 代码质量与风格 |
| 函数没有 docstring | -1 分/函数 | 代码质量与风格 |
| 代码格式混乱（缩进不一致） | -3 分 | 代码质量与风格 |

---

## 额外加分项（最多 +10 分）

| 加分项 | 分值 | 说明 |
|--------|------|------|
| 完成进阶练习 5（数据迁移） | +5 分 | 迁移逻辑正确，有版本检测 |
| 完成进阶练习 6（配置管理器） | +5 分 | 功能完整，支持嵌套键 |
| 完成 AI 协作练习 7 | +5 分 | 正确识别 AI 代码的问题并修复 |
| 代码质量特别优秀 | +2 分 | 超越基本要求，有创新点 |

**注意**：加分项总分不超过 10 分。

---

## 测试验证要求

### 自动测试（20 分）

运行 `python3 -m pytest chapters/week_10/tests -q` 必须通过：

```bash
$ python3 -m pytest chapters/week_10/tests -q
............                                                      [100%]
12 passed in 0.5s
```

**测试通过**：不扣分
**测试失败**：每个失败的测试 -2 分

### 手动验证（10 分）

Reviewer 会手动验证以下内容：

- [ ] 练习 1：`practice1_json_basics.py` 生成的 JSON 文件格式正确
- [ ] 练习 2：`practice2_data_exchange.py` 导入导出功能正常
- [ ] 练习 3：`practice3_serialization.py` 日期序列化正确
- [ ] 练习 4：`practice4_defensive_programming.py` 能处理损坏的 JSON

**每项不通过**：-2.5 分

---

## Reviewer 检查清单

### 代码正确性检查

- [ ] 运行 `python3 practice1_json_basics.py` 是否正常？
- [ ] 生成的 JSON 文件格式是否正确？
- [ ] 运行 `python3 practice2_data_exchange.py` 是否正常？
- [ ] 导入导出功能是否完整？
- [ ] 运行 `python3 practice3_serialization.py` 是否正常？
- [ ] 日期序列化和反序列化是否正确？
- [ ] 运行 `python3 practice4_defensive_programming.py` 是否正常？

### JSON 处理能力检查

- [ ] 是否正确使用 `json.dump` 和 `json.dumps`？
- [ ] 是否正确使用 `json.load` 和 `json.loads`？
- [ ] 是否正确处理中文编码？
- [ ] 是否正确处理嵌套结构？
- [ ] 是否正确处理日期序列化？

### 异常处理检查

- [ ] 是否处理了文件不存在的情况？
- [ ] 是否处理了 JSON 解析错误？
- [ ] 是否处理了编码错误？
- [ ] 是否有数据验证逻辑？
- [ ] 遇到错误时是否优雅降级？

### 代码风格检查

- [ ] 是否使用 `with` 语句管理文件？
- [ ] 函数是否有 docstring？
- [ ] 命名是否符合规范？
- [ ] 代码缩进是否一致？

---

## 反馈模板

Reviewer 在 PR 中给反馈时，可以使用以下模板：

```markdown
## Week 10 作业评分

### 得分：XX / 100

### 代码正确性（40 分）：XX / 40
- ✅ / ❌ 练习 1：JSON 基础读写（XX / 10）
- ✅ / ❌ 练习 2：数据导入导出（XX / 12）
- ✅ / ❌ 练习 3：序列化与反序列化（XX / 8）
- ✅ / ❌ 练习 4：防御性编程（XX / 10）

**问题**：
- （列出具体问题）

### JSON 处理能力（25 分）：XX / 25
- ✅ / ❌ json 模块使用（XX / 10）
- ✅ / ❌ 序列化与反序列化（XX / 8）
- ✅ / ❌ 数据格式处理（XX / 7）

**问题**：
- （列出具体问题）

### 异常处理与健壮性（20 分）：XX / 20
- ✅ / ❌ 文件操作异常（XX / 6）
- ✅ / ❌ JSON 解析异常（XX / 6）
- ✅ / ❌ 数据验证（XX / 5）
- ✅ / ❌ 防御性编程（XX / 3）

**问题**：
- （列出具体问题）

### 代码质量与风格（15 分）：XX / 15
- ✅ / ❌ 命名规范（XX / 5）
- ✅ / ❌ 注释与文档（XX / 5)
- ✅ / ❌ 代码结构（XX / 5）

**问题**：
- （列出具体问题）

### 加分项：+XX / 10
- ✅ / ❌ 进阶练习 5（+5 分）
- ✅ / ❌ 进阶练习 6（+5 分）
- ✅ / ❌ AI 协作练习 7（+5 分）
- ✅ / ❌ 代码质量特别优秀（+2 分）

### 总评

**优点**：
- （列出做得好的地方）

**改进建议**：
- （列出需要改进的地方）

### 是否需要修改后重新 review？
- [ ] 是，请在 XX 天内修改后重新提交
- [ ] 否，可以 merge
```

---

## 学生自检清单

在提交前，请确认：

### 代码正确性
- [ ] 所有练习都能运行
- [ ] JSON 文件格式正确
- [ ] 中文显示正常（不是 `\uXXXX`）
- [ ] 日期序列化和反序列化正确

### JSON 处理能力
- [ ] 正确区分 `dump` 和 `dumps`
- [ ] 正确区分 `load` 和 `loads`
- [ ] 正确处理嵌套结构
- [ ] 正确处理自定义类型（如日期）

### 异常处理
- [ ] 处理了文件不存在的情况
- [ ] 处理了 JSON 解析错误
- [ ] 处理了编码错误
- [ ] 有数据验证逻辑
- [ ] 遇到错误时不崩溃

### 代码质量
- [ ] 使用 `with` 语句管理文件
- [ ] 函数有 docstring
- [ ] 命名符合规范
- [ ] 代码格式整洁

### 测试验证
- [ ] 运行 `pytest` 通过所有测试
- [ ] 手动验证各功能正常

只有当以上所有项都打勾时，才建议提交作业。
