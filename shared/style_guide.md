# 行文与格式风格指南

## 总体风格

- 面向初学者：不默认读者知道"为什么要这样做"。
- 小步快跑：每节只讲一个主点，配一个最小例子。
- 工程化：每个重要结论都可验证（tests 或 anchors）。
- **叙事优先**：像写故事一样写教材，不是在填模板。

## 写作口吻与节奏（反"模板感/AI味"）

目标：读起来像真人老师写的教材，而不是"模板填空"。

**详细的好/坏范例见 `shared/writing_exemplars.md`**——所有写正文的 agent 在动笔前必须读。

### 核心节奏要求

- **场景开头**：每节用一个具体情境、问题或从上一节的自然过渡开头。绝不用"在本节中，我们将…"。
- **问题驱动**：先让读者感受到"我需要解决这个问题"，再引出概念。概念是答案，不是前提。
- **句子长短交替**：长句解释背景，短句敲定结论。"所以记住：`input()` 返回的永远是字符串。"
- **段落优先于列表**：能用 2-3 句话说清楚的事，不要拆成 bullet list。连续列表不超过 5 条。
- **过渡要自然**：节与节之间不能只靠 `---` 分隔。收束当前节时自然带出下一节的需求。

### 每节必须覆盖的要素（但形式灵活）

每节需要自然地包含以下内容，但**不要求使用固定的子标题模式**：

1. 读者为什么需要这个概念（动机）
2. 至少一个可运行的代码示例
3. 至少一个错误场景（在叙事中自然出现）
4. 本节与前后节的连接

### 写法示范（before / after）

**❌ 坏：概念先行 + bullet 小结**

> ## 变量与赋值
>
> 变量的作用就是给数据"贴标签"。
>
> ```python
> name = "Alice"
> ```
>
> ### 小结
> - 变量是数据的标签
> - 用 `=` 赋值
> - 变量名区分大小写

**✅ 好：场景驱动 + 叙述收束**

> ## 让程序记住东西
>
> 上一节你让 Python 说了 Hello——但说完就忘了。如果你想先问用户叫什么，再用名字打招呼呢？
>
> ```python
> name = input("你叫什么？")
> print("你好，" + name)
> ```
>
> `name` 就是一个变量——你给一个值取了个名字，后面的代码随时可以用。
>
> 现在你的程序能记东西了。下一个问题：如果记住的是数字，你能拿它做运算吗？

### 禁止事项

- 反复使用同一种开场句式（如每节都"在本节中…"）
- 每节都用相同的子标题结构（如"最小正例""常见错误""小结"）
- 连续 6+ 条 bullet list
- 元话语（"作为一个 AI…""接下来我会…"）
- 说教标签（"注意：""重要提示：""关键点："）
- 夸大 AI 能力或给出未经验证的事实

## 贯穿案例（每章必须）

每章围绕一个渐进式小项目展开。详见 `shared/writing_exemplars.md` 的范例 5。

要求：
- 每节结束时，读者手里的项目都是可运行的
- 每节在上一节基础上推进一步
- 章末读者拿到一个有意义的"小成果"

## PyHelper 超级线（每章必须）

除了每周独立案例，每章还需要一节 `## PyHelper 进度`，推进全书贯穿项目。详见 `shared/book_project.md`。

要求：
- 放在最后一个知识点之后、小结之前
- 代码必须在上周基础上增量修改
- 占正文 20-30%，不要喧宾夺主

## 循环角色（每章必须）

全书使用 3 个循环角色（小北、阿码、老潘）增强代入感。详见 `shared/characters.yml`。

要求：
- 每章至少出场 2 次
- 角色用来制造对话感和多视角，不是装饰
- 角色性格前后一致（由 `consistency-editor` 检查）

## 回顾桥（非 Week 01 必须）

在新内容中自然引用前几周学过的概念。详见 `CLAUDE.md` 的"认知负荷预算"章节和 `shared/concept_map.yml`。

要求：
- 不是生硬的"复习"，而是在新场景下让旧概念再次出场
- 数量参考：入门阶段至少 2 个/周，进阶阶段至少 2 个/周，实战阶段至少 3 个/周

## Markdown 规范

- 章节标题：`# week_XX：标题`（目录名也是 `week_XX/`）
- 小节用 `##`，子节用 `###`，避免跳级
- 小节标题用**动词/疑问句式**，不用干巴巴的概念名词
  - ❌ "变量与赋值"  ✅ "让程序记住东西"
  - ❌ "输入与输出"  ✅ "跟用户聊起来"
- 代码块必须标注语言：```python / ```bash / ```text

## 代码示例规范

- 示例优先放 `examples/`，正文只引用关键片段或给出运行命令。
- 代码不能孤零零地出现。前面要有"为什么写这段代码"，后面要有"运行后会看到什么"。
- 每个例子要说明：
  - 输入是什么
  - 输出是什么
  - 常见错误是什么（至少 1 个，在叙事中自然出现）

## 术语规范

- 首次出现：中文 + （英文）
- 需要统一写法的术语必须入 `TERMS.yml` 并合入 `shared/glossary.yml`

## 周间衔接

- 每周 CHAPTER.md 末尾必须有"## 本周小结（供下周参考）"段落（2-3 句话概括核心内容 + 展望下周）。
- 非 week_01 的 CHAPTER.md 开头应有"前情提要"过渡段（2-4 句话自然带入，不要机械复制上周小结）。
- 详见 `shared/week_summary_template.md`。

## 图表（可选）

能用短代码或伪代码表达就不要画复杂图。必须画图时，优先 Mermaid。

## Git 本周要点（固定盒子模板）

每周 `CHAPTER.md` 建议包含以下固定段落（复制后再按本周内容替换）。

```text
## Git 本周要点

本周必会命令：
- git status
- git diff
- git add -A
- git commit -m "draft: ..."
- git log --oneline -n 10

常见坑：
- 只改文件不提交：下周找不到"当时怎么改的"。至少做 draft + verify 两次提交。

Pull Request (PR)：
- Gitea 上也叫 Pull Request，流程等价 GitHub：push 分支 -> 开 PR -> review -> merge。
```

## AI 时代小专栏（每章必须）

目的：给初学者一个"时代背景"，理解近两年 AI 对编程方式的影响。好的侧栏能让读者觉得"学这些东西是有现实意义的"，而不是在做脱离时代的练习。

### 数量与位置（硬约束）

- 每章 **2 个**侧栏，每个 200-500 字。
- **位置分布**：
  - 第 1 个：放在**第 1-2 节之后**（章节前段），让读者一开始就感受到时代背景。
  - 第 2 个：放在**第 3-4 节之间**（章节中段），在读者有一定知识积累后深入讨论。
  - **禁止全部堆在章末。** 侧栏的作用是调节阅读节奏、制造"喘息点"，放在末尾等于浪费。

### 内容要求

- 必须和**相邻小节的主题**有连接点（不是泛泛的"AI 和编程"）。
- 优先使用**有数据、有出处的事实**（而非观点）。搜索关键词参考：GitHub Copilot 统计、Python 语言排名、vibe coding、AI 代码安全性等。
- 涉及事实性表述时，给 2-5 条参考链接 + 访问日期。
- **写侧栏的 agent 必须尝试联网搜索**（用 Bash 执行 `curl` 或使用 WebFetch）获取最新数据。如果确实无法联网，写 `<!-- TODO: 需联网补充 -->`，不要编造。

### 语气

- 像教材里的"阅读材料"或"课外延伸"，不是新闻稿。
- 可以有观点，但观点要有数据支撑。
- 结尾用一句话回扣当前学习内容（"所以你刚学的 XXX，在 AI 时代其实更重要了"）。

### 格式

```text
> **AI 时代小专栏：标题**
>
> ...（200-500 字，连接相邻小节主题）
>
> 参考（访问日期：YYYY-MM-DD）：
> - https://...
```
